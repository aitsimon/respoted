import{Q as R}from"./QChip.190cff57.js";import{F as ge,G as O,z as Ce,H as ke,I,J as G,aR as ae,aS as Y,K as W,M as N,L as qe,d as we,S as Me,m as z,U as xe,f as y,aL as Ee,t as Ae,aH as Pe,aG as Oe,y as Te,h as M,v as De,a5 as le,j as je,aT as K,aJ as oe,_ as He,a7 as $e,x as Be,o as q,c as T,w as E,a3 as S,ae as A,ay as D,a0 as i,a4 as L,an as j,aw as H,a as $,a2 as Fe,a1 as Qe,aM as Re,X as Ie,az as Le,aA as Ve}from"./index.1c897ed3.js";import{a as re,Q as Xe}from"./QResizeObserver.d4ca912a.js";import{g as se,s as ie,c as Ge}from"./selection.8640e7c4.js";import{b as V}from"./format.801e7424.js";import{Q as Ye}from"./QPage.e63976a5.js";import{u as Ne}from"./use-quasar.4bcd9f96.js";import{u as Ke}from"./fetchService.ed6b6eff.js";import{u as Ue}from"./auxApiService.c5a2ff45.js";import{_ as Je}from"./TheSearchFilters.a8c247d0.js";function U(r,u,h){const f=W(r);let t,a=f.left-u.event.x,o=f.top-u.event.y,e=Math.abs(a),c=Math.abs(o);const d=u.direction;d.horizontal===!0&&d.vertical!==!0?t=a<0?"left":"right":d.horizontal!==!0&&d.vertical===!0?t=o<0?"up":"down":d.up===!0&&o<0?(t="up",e>c&&(d.left===!0&&a<0?t="left":d.right===!0&&a>0&&(t="right"))):d.down===!0&&o>0?(t="down",e>c&&(d.left===!0&&a<0?t="left":d.right===!0&&a>0&&(t="right"))):d.left===!0&&a<0?(t="left",e<c&&(d.up===!0&&o<0?t="up":d.down===!0&&o>0&&(t="down"))):d.right===!0&&a>0&&(t="right",e<c&&(d.up===!0&&o<0?t="up":d.down===!0&&o>0&&(t="down")));let g=!1;if(t===void 0&&h===!1){if(u.event.isFirst===!0||u.event.lastDir===void 0)return{};t=u.event.lastDir,g=!0,t==="left"||t==="right"?(f.left-=a,e=0,a=0):(f.top-=o,c=0,o=0)}return{synthetic:g,payload:{evt:r,touch:u.event.mouse!==!0,mouse:u.event.mouse===!0,position:f,direction:t,isFirst:u.event.isFirst,isFinal:h===!0,duration:Date.now()-u.event.time,distance:{x:e,y:c},offset:{x:a,y:o},delta:{x:f.left-u.event.lastX,y:f.top-u.event.lastY}}}}let We=0;var ne=ge({name:"touch-pan",beforeMount(r,{value:u,modifiers:h}){if(h.mouse!==!0&&O.has.touch!==!0)return;function f(a,o){h.mouse===!0&&o===!0?qe(a):(h.stop===!0&&Y(a),h.prevent===!0&&ae(a))}const t={uid:"qvtp_"+We++,handler:u,modifiers:h,direction:se(h),noop:Ce,mouseStart(a){ie(a,t)&&ke(a)&&(I(t,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),t.start(a,!0))},touchStart(a){if(ie(a,t)){const o=a.target;I(t,"temp",[[o,"touchmove","move","notPassiveCapture"],[o,"touchcancel","end","passiveCapture"],[o,"touchend","end","passiveCapture"]]),t.start(a)}},start(a,o){if(O.is.firefox===!0&&G(r,!0),t.lastEvt=a,o===!0||h.stop===!0){if(t.direction.all!==!0&&(o!==!0||t.modifiers.mouseAllDir!==!0&&t.modifiers.mousealldir!==!0)){const d=a.type.indexOf("mouse")>-1?new MouseEvent(a.type,a):new TouchEvent(a.type,a);a.defaultPrevented===!0&&ae(d),a.cancelBubble===!0&&Y(d),Object.assign(d,{qKeyEvent:a.qKeyEvent,qClickOutside:a.qClickOutside,qAnchorHandled:a.qAnchorHandled,qClonedBy:a.qClonedBy===void 0?[t.uid]:a.qClonedBy.concat(t.uid)}),t.initialEvent={target:a.target,event:d}}Y(a)}const{left:e,top:c}=W(a);t.event={x:e,y:c,time:Date.now(),mouse:o===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:e,lastY:c}},move(a){if(t.event===void 0)return;const o=W(a),e=o.left-t.event.x,c=o.top-t.event.y;if(e===0&&c===0)return;t.lastEvt=a;const d=t.event.mouse===!0,g=()=>{f(a,d);let v;h.preserveCursor!==!0&&h.preservecursor!==!0&&(v=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),d===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Ge(),t.styleCleanup=m=>{if(t.styleCleanup=void 0,v!==void 0&&(document.documentElement.style.cursor=v),document.body.classList.remove("non-selectable"),d===!0){const s=()=>{document.body.classList.remove("no-pointer-events--children")};m!==void 0?setTimeout(()=>{s(),m()},50):s()}else m!==void 0&&m()}};if(t.event.detected===!0){t.event.isFirst!==!0&&f(a,t.event.mouse);const{payload:v,synthetic:m}=U(a,t,!1);v!==void 0&&(t.handler(v)===!1?t.end(a):(t.styleCleanup===void 0&&t.event.isFirst===!0&&g(),t.event.lastX=v.position.left,t.event.lastY=v.position.top,t.event.lastDir=m===!0?void 0:v.direction,t.event.isFirst=!1));return}if(t.direction.all===!0||d===!0&&(t.modifiers.mouseAllDir===!0||t.modifiers.mousealldir===!0)){g(),t.event.detected=!0,t.move(a);return}const k=Math.abs(e),_=Math.abs(c);k!==_&&(t.direction.horizontal===!0&&k>_||t.direction.vertical===!0&&k<_||t.direction.up===!0&&k<_&&c<0||t.direction.down===!0&&k<_&&c>0||t.direction.left===!0&&k>_&&e<0||t.direction.right===!0&&k>_&&e>0?(t.event.detected=!0,t.move(a)):t.end(a,!0))},end(a,o){if(t.event!==void 0){if(N(t,"temp"),O.is.firefox===!0&&G(r,!1),o===!0)t.styleCleanup!==void 0&&t.styleCleanup(),t.event.detected!==!0&&t.initialEvent!==void 0&&t.initialEvent.target.dispatchEvent(t.initialEvent.event);else if(t.event.detected===!0){t.event.isFirst===!0&&t.handler(U(a===void 0?t.lastEvt:a,t).payload);const{payload:e}=U(a===void 0?t.lastEvt:a,t,!0),c=()=>{t.handler(e)};t.styleCleanup!==void 0?t.styleCleanup(c):c()}t.event=void 0,t.initialEvent=void 0,t.lastEvt=void 0}}};if(r.__qtouchpan=t,h.mouse===!0){const a=h.mouseCapture===!0||h.mousecapture===!0?"Capture":"";I(t,"main",[[r,"mousedown","mouseStart",`passive${a}`]])}O.has.touch===!0&&I(t,"main",[[r,"touchstart","touchStart",`passive${h.capture===!0?"Capture":""}`],[r,"touchmove","noop","notPassiveCapture"]])},updated(r,u){const h=r.__qtouchpan;h!==void 0&&(u.oldValue!==u.value&&(typeof value!="function"&&h.end(),h.handler=u.value),h.direction=se(u.modifiers))},beforeUnmount(r){const u=r.__qtouchpan;u!==void 0&&(u.event!==void 0&&u.end(),N(u,"main"),N(u,"temp"),O.is.firefox===!0&&G(r,!1),u.styleCleanup!==void 0&&u.styleCleanup(),delete r.__qtouchpan)}});const ue=["vertical","horizontal"],J={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},ce={prevent:!0,mouse:!0,mouseAllDir:!0},de=r=>r>=250?50:Math.ceil(r/5);var Ze=we({name:"QScrollArea",props:{...Me,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(r,{slots:u,emit:h}){const f=z(!1),t=z(!1),a=z(!1),o={vertical:z(0),horizontal:z(0)},e={vertical:{ref:z(null),position:z(0),size:z(0)},horizontal:{ref:z(null),position:z(0),size:z(0)}},{proxy:c}=je(),d=xe(r,c.$q);let g=null,k;const _=z(null),v=y(()=>"q-scrollarea"+(d.value===!0?" q-scrollarea--dark":""));e.vertical.percentage=y(()=>{const l=e.vertical.size.value-o.vertical.value;if(l<=0)return 0;const n=V(e.vertical.position.value/l,0,1);return Math.round(n*1e4)/1e4}),e.vertical.thumbHidden=y(()=>(r.visible===null?a.value:r.visible)!==!0&&f.value===!1&&t.value===!1||e.vertical.size.value<=o.vertical.value+1),e.vertical.thumbStart=y(()=>e.vertical.percentage.value*(o.vertical.value-e.vertical.thumbSize.value)),e.vertical.thumbSize=y(()=>Math.round(V(o.vertical.value*o.vertical.value/e.vertical.size.value,de(o.vertical.value),o.vertical.value))),e.vertical.style=y(()=>({...r.thumbStyle,...r.verticalThumbStyle,top:`${e.vertical.thumbStart.value}px`,height:`${e.vertical.thumbSize.value}px`})),e.vertical.thumbClass=y(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(e.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),e.vertical.barClass=y(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(e.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),e.horizontal.percentage=y(()=>{const l=e.horizontal.size.value-o.horizontal.value;if(l<=0)return 0;const n=V(Math.abs(e.horizontal.position.value)/l,0,1);return Math.round(n*1e4)/1e4}),e.horizontal.thumbHidden=y(()=>(r.visible===null?a.value:r.visible)!==!0&&f.value===!1&&t.value===!1||e.horizontal.size.value<=o.horizontal.value+1),e.horizontal.thumbStart=y(()=>e.horizontal.percentage.value*(o.horizontal.value-e.horizontal.thumbSize.value)),e.horizontal.thumbSize=y(()=>Math.round(V(o.horizontal.value*o.horizontal.value/e.horizontal.size.value,de(o.horizontal.value),o.horizontal.value))),e.horizontal.style=y(()=>({...r.thumbStyle,...r.horizontalThumbStyle,[c.$q.lang.rtl===!0?"right":"left"]:`${e.horizontal.thumbStart.value}px`,width:`${e.horizontal.thumbSize.value}px`})),e.horizontal.thumbClass=y(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(e.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),e.horizontal.barClass=y(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(e.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const m=y(()=>e.vertical.thumbHidden.value===!0&&e.horizontal.thumbHidden.value===!0?r.contentStyle:r.contentActiveStyle),s=[[ne,l=>{Z(l,"vertical")},void 0,{vertical:!0,...ce}]],b=[[ne,l=>{Z(l,"horizontal")},void 0,{horizontal:!0,...ce}]];function w(){const l={};return ue.forEach(n=>{const p=e[n];l[n+"Position"]=p.position.value,l[n+"Percentage"]=p.percentage.value,l[n+"Size"]=p.size.value,l[n+"ContainerSize"]=o[n].value}),l}const C=Ee(()=>{const l=w();l.ref=c,h("scroll",l)},0);function X(l,n,p){if(ue.includes(l)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(l==="vertical"?oe:K)(_.value,n,p)}function ve({height:l,width:n}){let p=!1;o.vertical.value!==l&&(o.vertical.value=l,p=!0),o.horizontal.value!==n&&(o.horizontal.value=n,p=!0),p===!0&&B()}function he({position:l}){let n=!1;e.vertical.position.value!==l.top&&(e.vertical.position.value=l.top,n=!0),e.horizontal.position.value!==l.left&&(e.horizontal.position.value=l.left,n=!0),n===!0&&B()}function fe({height:l,width:n}){e.horizontal.size.value!==n&&(e.horizontal.size.value=n,B()),e.vertical.size.value!==l&&(e.vertical.size.value=l,B())}function Z(l,n){const p=e[n];if(l.isFirst===!0){if(p.thumbHidden.value===!0)return;k=p.position.value,t.value=!0}else if(t.value!==!0)return;l.isFinal===!0&&(t.value=!1);const x=J[n],Q=o[n].value,_e=(p.size.value-Q)/(Q-p.thumbSize.value),ze=l.distance[x.dist],Se=k+(l.direction===x.dir?1:-1)*ze*_e;te(Se,n)}function ee(l,n){const p=e[n];if(p.thumbHidden.value!==!0){const x=l[J[n].offset];if(x<p.thumbStart.value||x>p.thumbStart.value+p.thumbSize.value){const Q=x-p.thumbSize.value/2;te(Q/o[n].value*p.size.value,n)}p.ref.value!==null&&p.ref.value.dispatchEvent(new MouseEvent(l.type,l))}}function pe(l){ee(l,"vertical")}function me(l){ee(l,"horizontal")}function B(){f.value=!0,g!==null&&clearTimeout(g),g=setTimeout(()=>{g=null,f.value=!1},r.delay),r.onScroll!==void 0&&C()}function te(l,n){_.value[J[n].scroll]=l}function be(){a.value=!0}function ye(){a.value=!1}let F=null;return Ae(()=>c.$q.lang.rtl,l=>{_.value!==null&&K(_.value,Math.abs(e.horizontal.position.value)*(l===!0?-1:1))}),Pe(()=>{F={top:e.vertical.position.value,left:e.horizontal.position.value}}),Oe(()=>{if(F===null)return;const l=_.value;l!==null&&(K(l,F.left),oe(l,F.top))}),Te(C.cancel),Object.assign(c,{getScrollTarget:()=>_.value,getScroll:w,getScrollPosition:()=>({top:e.vertical.position.value,left:e.horizontal.position.value}),getScrollPercentage:()=>({top:e.vertical.percentage.value,left:e.horizontal.percentage.value}),setScrollPosition:X,setScrollPercentage(l,n,p){X(l,n*(e[l].size.value-o[l].value)*(l==="horizontal"&&c.$q.lang.rtl===!0?-1:1),p)}}),()=>M("div",{class:v.value,onMouseenter:be,onMouseleave:ye},[M("div",{ref:_,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:r.tabindex!==void 0?r.tabindex:void 0},[M("div",{class:"q-scrollarea__content absolute",style:m.value},De(u.default,[M(re,{debounce:0,onResize:fe})])),M(Xe,{axis:"both",onScroll:he})]),M(re,{debounce:0,onResize:ve}),M("div",{class:e.vertical.barClass.value,style:[r.barStyle,r.verticalBarStyle],"aria-hidden":"true",onMousedown:pe}),M("div",{class:e.horizontal.barClass.value,style:[r.barStyle,r.horizontalBarStyle],"aria-hidden":"true",onMousedown:me}),le(M("div",{ref:e.vertical.ref,class:e.vertical.thumbClass.value,style:e.vertical.style.value,"aria-hidden":"true"}),s),le(M("div",{ref:e.horizontal.ref,class:e.horizontal.thumbClass.value,style:e.horizontal.style.value,"aria-hidden":"true"}),b)])}});const P=r=>(Le("data-v-39f17080"),r=r(),Ve(),r),et=P(()=>S("h1",{class:"text-h4"},"Create a playlist based on your recommendations",-1)),tt={class:"row items-center justify-start q-py-md"},at=P(()=>S("h2",{class:"text-h5 col-12"},"Check our recommendations",-1)),lt={class:"row justify-start items-center q-my-sm"},ot={class:"row"},rt=P(()=>S("h3",{class:"text-h6 col-12"},"Artists Seeds",-1)),st={class:"row justify-start items-center q-my-sm"},it=P(()=>S("h3",{class:"text-h6 col-12"},"Track Seeds",-1)),nt={class:"row"},ut={class:"column full-width items-start justify-center no-wrap"},ct=P(()=>S("h3",{class:"text-h6 col-12"},"Genre Seeds",-1)),dt=P(()=>S("h3",{class:"text-h5"},"Or search yourself",-1)),vt={class:"full-width column"},ht={key:0,class:"q-mt-sm"},ft=P(()=>S("span",null,"Nothing Searched",-1)),pt=[ft],mt={class:"text-capitalize text-subtitle1"},bt={class:"row flex-center q-my-md q-my-lg-lg"},yt={__name:"Recommender",setup(r){const u=Ne(),h=$e(),f=Ke(),t=Ue();let a=z([]),o=z([]);z([]),Be(async()=>{a.value=f.userTopArtists.items.slice(0,10),o.value=f.userTopContent.items.slice(0,10),u.dialog({title:"Instructions",message:"Create a playlist based on your favorite artists, tracks and genres. Choose at least one of each between the given suggestions or search for your own.",persistent:!0,color:"accent"}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})});let e=z([]),c=z(""),d=y(()=>{var v;return((v=c.value)==null?void 0:v.length)>0}),g=y(()=>{let v=[],m=[],s=[];return e.value.length>0?(e.value.forEach(b=>{typeof b=="string"?s.push(b):b.type==="track"?m.push(b.id):b.type==="artist"?(v.push(b.id),f.avaibleGenreSeeds.genres.includes(b.genres[0])&&m.push(b.genres[0])):b.type==="album"?b.artists.forEach(w=>{v.includes(w.id)||v.push(w.id)}):console.log("item.type",b.type)}),v.length>5&&(v=v.slice(0,5)),m.length>5&&(m=m.slice(0,5)),s.length>5&&(s=s.slice(0,5)),s.length>0&&m.length>0&&v.length>0?{seedArtists:v.join(","),seedTracks:m.join(","),seedGenres:s.join(",")}:!1):!1});function k(v){v?u.dialog({title:"Leave this page?",message:"Do you want to see the playlist that has been created based on your recommendations?",cancel:!0,persistent:!0}).onOk(()=>{h.push({name:"RecommendedPlaylist"})}).onCancel(()=>{}).onDismiss(()=>{}):u.dialog({title:"Error",message:"Something went wrong, please try again."}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})}async function _(){g.value?(await t.getRecommendations(g.value),k(!0)):console.log("invalid seeds")}return(v,m)=>(q(),T(Ye,null,{default:E(()=>[et,S("div",tt,[at,S("div",lt,[S("div",ot,[rt,(q(!0),A(H,null,D(i(a),(s,b)=>(q(),T(R,{key:b,clickable:"",color:i(e).includes(s)?"accent":"secondary","text-color":"primary",icon:i(e).includes(s)?"check":"person_search",size:"md",dense:"",id:s.id,onClick:w=>i(e).includes(s)?i(e).splice(i(e).indexOf(s),1):i(e).push(s)},{default:E(()=>[L(j(s.name),1)]),_:2},1032,["color","icon","id","onClick"]))),128))])]),S("div",st,[it,S("div",nt,[(q(!0),A(H,null,D(i(o),(s,b)=>(q(),T(R,{key:b,clickable:"",color:i(e).includes(s)?"accent":"secondary","text-color":"primary",icon:i(e).includes(s)?"check":"music_note",size:"md",dense:"",id:s.id,onClick:w=>i(e).includes(s)?i(e).splice(i(e).indexOf(s),1):i(e).push(s)},{default:E(()=>[L(j(s.name),1)]),_:2},1032,["color","icon","id","onClick"]))),128))])]),S("div",ut,[ct,$(Ze,null,{default:E(()=>[(q(!0),A(H,null,D(i(f).avaibleGenreSeeds.genres,(s,b)=>(q(),T(R,{key:s,clickable:"",color:i(e).includes(s)?"accent":"secondary","text-color":"primary",icon:i(e).includes(s)?"check":"graphic_eq",size:"md",dense:"",id:s,onClick:w=>i(e).includes(s)?i(e).splice(i(e).indexOf(s),1):i(e).push(s)},{default:E(()=>[L(j(s),1)]),_:2},1032,["color","icon","id","onClick"]))),128))]),_:1})])]),S("div",null,[dt,S("div",vt,[$(Je,{onClick:m[0]||(m[0]=s=>i(d)?i(f).searchItem(i(c),i(f).searchFilters):"")}),$(Re,{clearable:"",filled:"",label:"What do you want to listen to?",modelValue:i(c),"onUpdate:modelValue":m[1]||(m[1]=s=>Qe(c)?c.value=s:c=s),onKeyup:m[2]||(m[2]=s=>i(f).searchItem(i(c),i(f).searchFilters))},{prepend:E(()=>[$(Fe,{name:"search"})]),_:1},8,["modelValue"])]),i(d)?(q(!0),A(H,{key:1},D(i(f).founditems,(s,b,w)=>(q(),A("div",{key:w},[S("h4",mt,j(b),1),(q(!0),A(H,null,D(s.items,C=>(q(),T(R,{clickable:"",color:i(e).includes(C)?"accent":"secondary","text-color":"primary",icon:i(e).includes(C)?"check":C.type==="artist"?"person_search":C.type==="track"?"music_note":C.type==="album"?"album":"queue_music",size:"md",dense:"",id:C.id,onClick:X=>i(e).includes(C)?i(e).splice(i(e).indexOf(C),1):i(e).push(C),class:"text-capitalize"},{default:E(()=>[L(j(C.name),1)]),_:2},1032,["color","icon","id","onClick"]))),256))]))),128)):(q(),A("div",ht,pt))]),S("div",bt,[$(Ie,{disable:!i(g),color:"accent",onClick:_,icon:"auto_mode",label:"Generate a playlist"},null,8,["disable"])])]),_:1}))}};var Et=He(yt,[["__scopeId","data-v-39f17080"]]);export{Et as default};
